<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Payroll Pro - v2.1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .no-select { user-select: none; -webkit-user-select: none; }
        .lang-btn.active { border-color: #60a5fa; color: #60a5fa; background: rgba(59, 130, 246, 0.15); }
        .loader { border: 4px solid rgba(255,255,255,0.1); border-left-color: #3b82f6; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-slate-900 text-white min-h-screen no-select">

    <div id="ad-overlay" class="fixed inset-0 bg-slate-950/95 z-[200] hidden flex-col justify-center items-center">
        <div class="loader mb-4"></div>
        <h2 id="ad-text-label" class="text-[10px] font-black text-blue-400 uppercase tracking-[0.4em]">Procesando</h2>
        <div id="ad-timer" class="mt-4 text-3xl font-black text-white">5</div>
    </div>

    <header class="p-4 bg-slate-800 border-b border-slate-700 sticky top-0 z-50">
        <div class="max-w-lg mx-auto flex justify-between items-center">
            <h1 class="text-xs font-black text-blue-400 uppercase">Payroll Pro</h1>
            <div class="flex gap-1">
                <button onclick="changeLanguage('es')" id="lang-es" class="lang-btn text-[9px] font-bold border border-slate-700 px-2 py-1.5 rounded-lg">ES</button>
                <button onclick="changeLanguage('en')" id="lang-en" class="lang-btn text-[9px] font-bold border border-slate-700 px-2 py-1.5 rounded-lg">EN</button>
                <button onclick="changeLanguage('it')" id="lang-it" class="lang-btn text-[9px] font-bold border border-slate-700 px-2 py-1.5 rounded-lg">IT</button>
                <button onclick="changeLanguage('pt')" id="lang-pt" class="lang-btn text-[9px] font-bold border border-slate-700 px-2 py-1.5 rounded-lg">PT</button>
            </div>
        </div>
    </header>

    <main class="p-4 max-w-lg mx-auto w-full">
        <div class="flex bg-slate-800 p-1 rounded-2xl mb-6 border border-slate-700">
            <button onclick="setModo('mes')" id="btn-mes" class="flex-1 py-3 rounded-xl bg-blue-600 font-bold text-[10px] uppercase">Mensual</button>
            <button onclick="setModo('semana')" id="btn-semana" class="flex-1 py-3 rounded-xl font-bold text-slate-500 text-[10px] uppercase">Semanal</button>
            <button onclick="setModo('horas')" id="btn-horas" class="flex-1 py-3 rounded-xl font-bold text-slate-500 text-[10px] uppercase">Horas</button>
        </div>

        <div class="space-y-4">
            <div class="bg-slate-800/50 p-4 rounded-2xl border border-slate-800">
                <label id="label-pais" class="text-[9px] font-black text-slate-500 uppercase block mb-2">PaÃ­s</label>
                <select id="pais" onchange="actualizarOpcionesAvanzadas()" class="w-full bg-transparent text-lg font-bold outline-none text-white">
                    <option value="ES">EspaÃ±a ðŸ‡ªðŸ‡¸</option>
                    <option value="UK">United Kingdom ðŸ‡¬ðŸ‡§</option>
                    <option value="IT">Italia ðŸ‡®ðŸ‡¹</option>
                    <option value="PT">Portugal ðŸ‡µðŸ‡¹</option>
                </select>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="bg-slate-800/50 p-4 rounded-2xl border border-slate-800">
                    <label id="label-salario" class="text-[9px] font-black text-slate-500 uppercase mb-1 block">Sueldo Bruto</label>
                    <input type="number" id="salario" class="w-full bg-transparent text-2xl font-black outline-none text-blue-400" placeholder="0">
                </div>
                <div class="bg-slate-800/50 p-4 rounded-2xl border border-slate-800">
                    <label id="label-tiempo" class="text-[9px] font-black text-slate-500 uppercase mb-1 block">DÃ­as</label>
                    <input type="number" id="tiempo" class="w-full bg-transparent text-2xl font-black outline-none" placeholder="30">
                </div>
            </div>

            <button onclick="toggleAvanzado()" class="w-full py-4 rounded-xl border border-slate-800 text-[9px] font-black text-slate-400 uppercase tracking-widest">
                <i class="fa-solid fa-gear mr-2"></i> <span id="btn-avanzado-text">Ajustes Avanzados</span>
            </button>

            <div id="panel-avanzado" class="hidden space-y-4 bg-slate-800/20 p-5 rounded-2xl border border-dashed border-slate-700">
                <div id="adv-uk" class="adv-section hidden space-y-4">
                    <div class="flex items-center justify-between"><label class="text-[10px] uppercase font-bold" id="label-uk-2job">Â¿2Âº Empleo?</label><input type="checkbox" id="uk-second-job"></div>
                    <div><label class="text-[10px] uppercase font-bold">PensiÃ³n %</label><input type="number" id="uk-pension" class="w-full bg-slate-900 p-2 rounded" placeholder="5"></div>
                </div>
                <div id="adv-it" class="adv-section hidden space-y-4">
                    <div><label class="text-[10px] uppercase font-bold" id="label-it-reg">Add. Regionale %</label><input type="number" id="it-reg" class="w-full bg-slate-900 p-2 rounded" placeholder="1.23"></div>
                    <div><label class="text-[10px] uppercase font-bold" id="label-it-com">Add. Comunale %</label><input type="number" id="it-com" class="w-full bg-slate-900 p-2 rounded" placeholder="0.8"></div>
                </div>
                <div id="adv-pt" class="adv-section hidden space-y-4">
                    <div><label class="text-[10px] uppercase font-bold" id="label-pt-civil">Estado Civil</label><select id="pt-estado" class="w-full bg-slate-900 p-2 rounded"><option value="solteiro">Solteiro</option><option value="casado">Casado</option></select></div>
                    <div><label class="text-[10px] uppercase font-bold" id="label-pt-filhos">Dependentes</label><input type="number" id="pt-filhos" class="w-full bg-slate-900 p-2 rounded" placeholder="0"></div>
                </div>
                <div id="adv-es" class="adv-section hidden">
                    <label class="text-[10px] uppercase font-bold">IRPF %</label><input type="number" id="es-irpf" class="w-full bg-slate-900 p-2 rounded" placeholder="Auto">
                </div>
            </div>

            <button onclick="validarYProcesar()" id="btn-calcular-main" class="w-full bg-blue-600 py-5 rounded-3xl text-lg font-black uppercase tracking-widest">Calcular Neto</button>
        </div>

        <section id="result-card" class="hidden mt-8">
            <div class="bg-gradient-to-br from-blue-700 to-indigo-950 rounded-[2.5rem] p-8 shadow-2xl">
                <p id="res-label-estimado" class="text-[9px] font-black text-blue-200 uppercase tracking-[0.4em] mb-2">Neto</p>
                <h2 id="neto-display" class="text-6xl font-black text-white mb-8 tracking-tighter">0.00</h2>
                <div class="space-y-4 text-xs font-bold border-t border-white/10 pt-6">
                    <div class="flex justify-between text-white/50"><span id="res-bruto-text">Bruto:</span><span id="bruto-display">0.00</span></div>
                    <div class="flex justify-between text-red-300"><span id="res-ss-text">Seg. Social:</span><span id="ss-display">-0.00</span></div>
                    <div class="flex justify-between text-red-300"><span id="res-tax-text">Impuestos:</span><span id="tax-display">-0.00</span></div>
                </div>
            </div>
        </section>
    </main>

    <script>
        let currentLang = 'es';
        let modoActual = 'mes';
        let contador = 0;

        const langData = {
            es: { pais: "PaÃ­s Fiscal", salario: "Sueldo Bruto", tiempo: "DÃ­as", avanzado: "Ajustes Avanzados", calcular: "Calcular Neto", neto: "Neto Final", bruto: "Bruto:", ss: "Seg. Social:", tax: "Impuestos:", proc: "Procesando...", uk2: "Â¿2Âº Empleo?", itreg: "Add. Regionale %", itcom: "Add. Comunale %", ptciv: "Estado Civil", ptdep: "Dependentes" },
            en: { pais: "Tax Country", salario: "Gross Salary", tiempo: "Days", avanzado: "Advanced Settings", calcular: "Calculate Net", neto: "Take-Home Pay", bruto: "Gross:", ss: "Social Security:", tax: "Tax:", proc: "Processing...", uk2: "Second Job?", itreg: "Reg. Tax %", itcom: "City Tax %", ptciv: "Marital Status", ptdep: "Dependents" },
            it: { pais: "Paese Fiscale", salario: "Lordo Totale", tiempo: "Giorni", avanzado: "Opzioni Avanzate", calcular: "Calcola Netto", neto: "Stipendio Netto", bruto: "Lordo:", ss: "Contributi:", tax: "Ritenute:", proc: "Elaborazione...", uk2: "2Âº Lavoro?", itreg: "Add. Regionale %", itcom: "Add. Comunale %", ptciv: "Stato Civile", ptdep: "Figli a Carico" },
            pt: { pais: "PaÃ­s Fiscal", salario: "Vencimento Bruto", tiempo: "Dias", avanzado: "OpÃ§Ãµes AvanÃ§adas", calcular: "Calcular LÃ­quido", neto: "SalÃ¡rio LÃ­quido", bruto: "Bruto:", ss: "Seg. Social:", tax: "IRS:", proc: "A Processar...", uk2: "2Âº Emprego?", itreg: "Taxa Regional %", itcom: "Taxa Municipal %", ptciv: "Estado Civil", ptdep: "Dependentes" }
        };

        function changeLanguage(l) {
            currentLang = l;
            const d = langData[l];
            document.getElementById('label-pais').textContent = d.pais;
            document.getElementById('label-salario').textContent = d.salario;
            document.getElementById('label-tiempo').textContent = d.tiempo;
            document.getElementById('btn-avanzado-text').textContent = d.avanzado;
            document.getElementById('btn-calcular-main').textContent = d.calcular;
            document.getElementById('res-label-estimado').textContent = d.neto;
            document.getElementById('res-bruto-text').textContent = d.bruto;
            document.getElementById('res-ss-text').textContent = d.ss;
            document.getElementById('res-tax-text').textContent = d.tax;
            document.getElementById('ad-text-label').textContent = d.proc;
            // Avanzados
            document.getElementById('label-uk-2job').textContent = d.uk2;
            document.getElementById('label-it-reg').textContent = d.itreg;
            document.getElementById('label-it-com').textContent = d.itcom;
            document.getElementById('label-pt-civil').textContent = d.ptciv;
            document.getElementById('label-pt-filhos').textContent = d.ptdep;

            document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('lang-'+l).classList.add('active');
        }

        function setModo(m) {
            modoActual = m;
            ['mes','semana','horas'].forEach(x => document.getElementById('btn-'+x).className = (x===m)?'flex-1 py-3 rounded-xl bg-blue-600 font-bold text-[10px] uppercase':'flex-1 py-3 rounded-xl font-bold text-slate-500 text-[10px] uppercase');
        }

        function toggleAvanzado() {
            document.getElementById('panel-avanzado').classList.toggle('hidden');
            actualizarOpcionesAvanzadas();
        }

        function actualizarOpcionesAvanzadas() {
            const p = document.getElementById('pais').value.toLowerCase();
            document.querySelectorAll('.adv-section').forEach(s => s.classList.add('hidden'));
            document.getElementById('adv-'+p).classList.remove('hidden');
        }

        function validarYProcesar() {
            contador++;
            if(contador === 1 || contador % 2 !== 0) {
                const overlay = document.getElementById('ad-overlay');
                overlay.classList.remove('hidden'); overlay.classList.add('flex');
                let s = 5; document.getElementById('ad-timer').textContent = s;
                const i = setInterval(() => {
                    s--; document.getElementById('ad-timer').textContent = s;
                    if(s<=0){ clearInterval(i); overlay.classList.add('hidden'); overlay.classList.remove('flex'); calcular(); }
                }, 1000);
            } else { calcular(); }
        }

        function calcular() {
            const p = document.getElementById('pais').value;
            const bBase = parseFloat(document.getElementById('salario').value) || 0;
            const t = parseFloat(document.getElementById('tiempo').value) || 0;
            const symb = (p==='UK')?'Â£':'â‚¬';
            let bruto = (modoActual==='horas')? bBase * t : bBase;
            let ss = 0, tax = 0;

            if(p==='ES'){ ss = bruto*0.0647; tax = bruto*0.15; }
            else if(p==='UK'){ 
                ss = (bruto>1048)? (bruto-1048)*0.08 : 0; 
                tax = document.getElementById('uk-second-job').checked ? bruto*0.20 : (bruto>1047? (bruto-1047)*0.20 : 0);
            }
            else if(p==='IT'){ ss = bruto*0.09; tax = bruto*0.23; }
            else if(p==='PT'){ ss = bruto*0.11; tax = bruto*0.14; }

            document.getElementById('bruto-display').textContent = bruto.toFixed(2)+symb;
            document.getElementById('neto-display').textContent = (bruto-ss-tax).toFixed(2)+symb;
            document.getElementById('ss-display').textContent = "-"+ss.toFixed(2)+symb;
            document.getElementById('tax-display').textContent = "-"+tax.toFixed(2)+symb;
            document.getElementById('result-card').classList.remove('hidden');
        }

        changeLanguage('es');
    </script>
</body>
</html>
